<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fabricatr - Using fabricatr with other data generating packages</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../">fabricatr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/variable_generation.html">Generating Variables</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Resampling</a>
    </li>
    <li>
      <a href="../articles/cross_classified.html">Cross-classified Data</a>
    </li>
    <li>
      <a href="../articles/advanced_features.html">Advanced Features</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/">Reference</a>
</li>
<li>
  <a href="http://discuss.declaredesign.org">Ask for Help</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://declaredesign.org">DeclareDesign</a>
    </li>
    <li>
      <a href="http://randomizr.declaredesign.org">randomizr</a>
    </li>
    <li>
      <a href="http://fabricatr.declaredesign.org">fabricatr</a>
    </li>
    <li>
      <a href="http://estimatr.declaredesign.org">estimatr</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://declaredesign.org">DeclareDesign home</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a></a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using fabricatr with other data generating packages</h1>
                        <h4 class="author">Aaron Rudkin</h4>
            
          </div>

    
    
<div class="contents">
<div id="using-fabricatr-with-other-data-generating-packges-" class="section level1">
<h1 class="hasAnchor">
<a href="#using-fabricatr-with-other-data-generating-packges-" class="anchor"></a>Using fabricatr with other data generating packges.</h1>
<p><strong>fabricatr</strong> works nicely with existing data generating packages that you may already use. Below, we offer brief examples of how to use <strong>fabricatr</strong> with these packages.</p>
<div id="using-fabricatr-with-wakefield" class="section level2">
<h2 class="hasAnchor">
<a href="#using-fabricatr-with-wakefield" class="anchor"></a>Using fabricatr with wakefield</h2>
<p>Tyler Rinker’s <strong><a href="https://github.com/trinker/wakefield">wakefield</a></strong> is one of the most commonly used R data generating packages. Like <strong>fabricatr</strong>, <strong>wakefield</strong> is designed to slot into a tidyverse workflow.</p>
<p>By default, <strong>wakefield</strong>’s generating functions return vectors and so can be used as variables within [<code><a href="../reference/fabricate.html">fabricate()</a></code>] calls or level calls:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wakefield)

observation_set =<span class="st"> </span><span class="kw"><a href="../reference/fabricate.html">fabricate</a></span>(<span class="dt">N =</span> <span class="dv">20</span>,
                            <span class="dt">obs_name =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/wakefield/topics/name">name</a></span>(<span class="dt">n =</span> N),
                            <span class="dt">obs_sex =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/wakefield/topics/sex">sex</a></span>(<span class="dt">n =</span> N),
                            <span class="dt">obs_age =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/wakefield/topics/age">age</a></span>(<span class="dt">n =</span> N, <span class="dt">x=</span><span class="dv">18</span><span class="op">:</span><span class="dv">65</span>),
                            <span class="dt">obs_income =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dv">35000</span>, <span class="dv">5000</span>))</code></pre></div>
<p>Observe that in this example data call, the <code>obs_name</code>, <code>obs_sex</code>, and <code>obs_age</code> variables are generated by wakefield, while the <code>obs_income</code> variable is generated using R’s random number generator. The data frame is packaged together by the fabricate call. It would be possible to extent this data set to have multiple nested levels, combining elements of <strong>fabricatr</strong> and <strong>wakefield</strong> data.</p>
<p>It is also possible to extend <strong>wakefield</strong> data by importing it, as a data frame, to a <strong>fabricate</strong> call. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(wakefield)

observations =<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/wakefield/topics/r_data_frame">r_data_frame</a></span>(<span class="dt">n =</span> <span class="dv">20</span>,
                            id,
                            name,
                            sex,
                            iq) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/fabricate.html">fabricate</a></span>(<span class="dt">test =</span> <span class="kw"><a href="../reference/fabricate.html">add_level</a></span>(<span class="dt">N =</span> <span class="dv">5</span>,
                             <span class="dt">score =</span> (IQ <span class="op">*</span><span class="st"> </span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">30</span>)))</code></pre></div>
<p>Here, data about human subjects is generated in <strong>wakefield</strong>, sent by the <code>%&gt;%</code> pipe operator from <strong>magrittr</strong> to a [<code><a href="../reference/fabricate.html">fabricate()</a></code>] call, where a nested level of test results is created. Test results in the <strong>fabricatr</strong> nested level can depend on the <code>iq</code> variable from the <strong>wakefield</strong> data frame. The result will be 100 observations (5 each for each of 20 people), with 6 variables (<code>id</code>, <code>name</code>, <code>sex</code>, <code>iq</code>, <code>test</code>, and <code>score</code>)</p>
</div>
<div id="using-fabricatr-with-datasynthr" class="section level2">
<h2 class="hasAnchor">
<a href="#using-fabricatr-with-datasynthr" class="anchor"></a>Using fabricatr with datasynthR</h2>
<p>Jared Knowles’ <strong>datasynthR</strong> is often used to generate correlated variables or to inject missingness into data sets. Both functions integrate nicely into a <strong>fabricatr</strong> workflow.</p>
<p>First, here is an example of using <strong>datasynthR</strong> to generate variables as part of a [<code><a href="../reference/fabricate.html">fabricate()</a></code>] call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(datasynthR)

observations &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fabricate.html">fabricate</a></span>(<span class="dt">N =</span> <span class="dv">1000</span>,
                          <span class="dt">income_quantile =</span> <span class="kw">runif</span>(N, <span class="dv">0</span>, <span class="dv">1</span>),
                          <span class="dt">wealth_quantile =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/datasynthR/topics/runifcor.cor">runifcor.cor</a></span>(income_quantile, <span class="dt">rho=</span><span class="fl">0.7</span>))</code></pre></div>
<p>Second, as above, is easy to use <strong>datasynthR</strong> to generate a data frame and pass that data frame to <strong>fabricatr</strong> for use, or vice versa. Here is an example of generating data with <strong>fabricatr</strong> and using <strong>datasynthR</strong> to create missingness completely at random:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(datasynthR)

obs_missing &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fabricate.html">fabricate</a></span>(<span class="dt">N=</span><span class="dv">100</span>,
                         <span class="dt">college_degree =</span> <span class="kw"><a href="../reference/draw_binomial.html">draw_binary</a></span>(<span class="dt">probs =</span> <span class="fl">0.3</span>, <span class="dt">N =</span> N),
                         <span class="dt">income =</span> <span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">35000</span>, <span class="dt">sd =</span> <span class="dv">5000</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">                           </span>college_degree <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">20000</span>, <span class="dt">sd =</span> <span class="dv">5000</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/datasynthR/topics/MCAR.df">MCAR.df</a></span>(<span class="fl">0.1</span>)</code></pre></div>
</div>
<div id="using-fabricatr-with-babynames" class="section level2">
<h2 class="hasAnchor">
<a href="#using-fabricatr-with-babynames" class="anchor"></a>Using fabricatr with babynames</h2>
<p><strong>babynames</strong> is a helper package containing a dataset of U.S. birth information, containing baby names by gender and year. In general, you can use packages that provide data sets either as part of creating variables, or as entire data frames to import into a <strong>fabricatr</strong> call.</p>
<p>Below we provide an example of using <strong>babynames</strong> as part of creating variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(babynames)

babynames_<span class="dv">2015</span> =<span class="st"> </span><span class="kw">subset</span>(babynames, year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>)

students &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fabricate.html">fabricate</a></span>(<span class="dt">N =</span> <span class="dv">500</span>,
                      <span class="dt">name =</span> <span class="kw">sample</span>(babynames_<span class="dv">2015</span><span class="op">$</span>name, 
                                    N, 
                                    <span class="dt">replace =</span> <span class="ot">TRUE</span>, 
                                    <span class="dt">prob =</span> babynames_<span class="dv">2015</span><span class="op">$</span>prop),
                      <span class="dt">height_inches =</span> <span class="kw">rnorm</span>(N, <span class="dv">70</span>, <span class="fl">1.5</span>))</code></pre></div>
</div>
<div id="using-fabricatr-with-uscensus2010" class="section level2">
<h2 class="hasAnchor">
<a href="#using-fabricatr-with-uscensus2010" class="anchor"></a>Using fabricatr with USCensus2010</h2>
</div>
<div id="other-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#other-packages" class="anchor"></a>Other packages</h2>
<p>In general <strong>fabricatr</strong> will integrate nicely with other packages if either a) their generating functions return vectors and you use them inside a [<code><a href="../reference/fabricate.html">fabricate()</a></code>] or level call; or b) their generating functions return data frames or tibbles and you import their data into a [<code><a href="../reference/fabricate.html">fabricate()</a></code>] call. If you make use of a data generating package that is not described here and would like help integrating it with <strong>fabricatr</strong>, please <a href="http://discuss.declaredesign.org/">ask us for help online</a> and we will be happy to add guidance for that package on this page or help you directly.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#using-fabricatr-with-other-data-generating-packges-">Using fabricatr with other data generating packges.</a><ul class="nav nav-pills nav-stacked">
<li><a href="#using-fabricatr-with-wakefield">Using fabricatr with wakefield</a></li>
      <li><a href="#using-fabricatr-with-datasynthr">Using fabricatr with datasynthR</a></li>
      <li><a href="#using-fabricatr-with-babynames">Using fabricatr with babynames</a></li>
      <li><a href="#using-fabricatr-with-uscensus2010">Using fabricatr with USCensus2010</a></li>
      <li><a href="#other-packages">Other packages</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright" style="flex:2;">
  <p>Developed by Graeme Blair, Jasper Cooper, Alexander Coppock, Macartan Humphreys, Aaron Rudkin.</p>
  <p>Code is licensed under <a href="https://opensource.org/licenses/mit-license.php">MIT</a> license.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
